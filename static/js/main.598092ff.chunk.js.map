{"version":3,"sources":["panels/Home.js","panels/Error.js","panels/Question.js","panels/QuePoll.js","App.js","index.js"],"names":["Home","_ref","id","go","fetchedUser","react_default","a","createElement","vkui","activePanel","title","before","photo_200","src","description","city","concat","first_name","last_name","size","level","onClick","data-to","Error","this","props","style","paddingTop","paddingBottom","color","textAlign","React","Component","Question","osname","platform","left","goB","IOS","chevron_back_default","back_default","data","JSON","stringify","goF","QuePoll","_this","Object","classCallCheck","possibleConstructorReturn","getPrototypeOf","call","goBack","hist","toConsumableArray","state","history","length","last","pop","n","parseInt","match","setState","sv","goForward","e","queId","currentTarget","dataset","to","keys","items","push","_this2","map","i","panels_Question","App","switchView","activeView","getPoll","xhr","XMLHttpRequest","open","send","status","res","parse","responseText","ok","ex","parseQueryString","string","slice","split","queryParam","kvp","key","value","reduce","query","isLoading","pollId","connect","subscribe","detail","type","console","log","hashParams","window","location","hash","includes","panels_Error","panels_QuePoll","panels_Home","ReactDOM","render","src_App","document","getElementById"],"mappings":"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","file":"static/js/main.598092ff.chunk.js","sourcesContent":["import React from 'react';\nimport PropTypes from 'prop-types';\nimport { Panel, View, ListItem, Button, Group, Div, Avatar, PanelHeader } from '@vkontakte/vkui';\n\nconst Home = ({ id, go, fetchedUser }) => (\n\t<View id={id} activePanel={id+\"_panel\"}>\n\t\t<Panel id={id+\"_panel\"}>\n\t\t\t<PanelHeader>Start Page</PanelHeader>\n\t\t\t{fetchedUser &&\n\t\t\t<Group title=\"User Data Fetched with VK Connect\">\n\t\t\t\t<ListItem\n\t\t\t\t\tbefore={fetchedUser.photo_200 ? <Avatar src={fetchedUser.photo_200}/> : null}\n\t\t\t\t\tdescription={fetchedUser.city && fetchedUser.city.title ? fetchedUser.city.title : ''}\n\t\t\t\t>\n\t\t\t\t\t{`${fetchedUser.first_name} ${fetchedUser.last_name}`}\n\t\t\t\t</ListItem>\n\t\t\t</Group>}\n\n\t\t\t<Group title=\"Pages\">\n\t\t\t\t<Div>\n\t\t\t\t\t<Button size=\"xl\" level=\"2\" onClick={go} data-to=\"quepoll\">\n\t\t\t\t\t\tQuestions\n\t\t\t\t\t</Button>\n\t\t\t\t</Div>\n\t\t\t\t<Div>\n\t\t\t\t\t<Button size=\"xl\" level=\"2\" onClick={go} data-to=\"error\">\n\t\t\t\t\t\tShow me 404\n\t\t\t\t\t</Button>\n\t\t\t\t</Div>\n\t\t\t</Group>\n\t\t</Panel>\n\t</View>\n);\n\nHome.propTypes = {\n\tid: PropTypes.string.isRequired,\n\tgo: PropTypes.func.isRequired,\n\tfetchedUser: PropTypes.shape({\n\t\tphoto_200: PropTypes.string,\n\t\tfirst_name: PropTypes.string,\n\t\tlast_name: PropTypes.string,\n\t\tcity: PropTypes.shape({\n\t\t\ttitle: PropTypes.string,\n\t\t}),\n\t}),\n};\n\nexport default Home;\n","import React from 'react';\r\nimport {Div, View, Panel, PanelHeader} from '@vkontakte/vkui';\r\nimport '@vkontakte/vkui/dist/vkui.css';\r\n\r\nclass Error extends React.Component{\r\n   render(){\r\n      return(\r\n         <View id={this.props.id} activePanel={this.props.id + \"_panel\"}>\r\n            <Panel id={this.props.id + \"_panel\"}>\r\n               <PanelHeader>\r\n                  404\r\n               </PanelHeader>\r\n               <Div style={{ paddingTop: 30, paddingBottom: 60, color: 'gray', textAlign: 'center' }}>\r\n                  <h2>404 Page Not Found</h2><br/>\r\n                  <p>Упс… Мы не можем найти то, что Вы ищете</p>\r\n               </Div>\r\n            </Panel>\r\n         </View>\r\n      );\r\n   }\r\n}\r\n\r\nexport default Error;\r\n","import React from 'react';\r\nimport {Div, Panel, Button, PanelHeader, HeaderButton, platform, IOS} from '@vkontakte/vkui';\r\nimport '@vkontakte/vkui/dist/vkui.css';\r\nimport Icon28ChevronBack from '@vkontakte/icons/dist/28/chevron_back';\r\nimport Icon24Back from '@vkontakte/icons/dist/24/back';\r\n\r\nclass Question extends React.Component{\r\n   render(){\r\n      const osname = platform();\r\n      return(\r\n         <Panel id={this.props.id}>\r\n            <PanelHeader\r\n               left={<HeaderButton onClick={this.props.goB}>\r\n                  {osname === IOS ? <Icon28ChevronBack/> : <Icon24Back/>}\r\n               </HeaderButton>}\r\n            >\r\n               {this.props.data.title}\r\n            </PanelHeader>\r\n\r\n            {JSON.stringify(this.props.data)}\r\n            {\r\n               ///Нужно добавить отображение вопросов\r\n            }\r\n            <Div>\r\n\t\t\t\t\t<Button size=\"l\" level=\"secondary\" onClick={this.props.goF} data-to={this.props.id}>\r\n\t\t\t\t\t\tNext\r\n\t\t\t\t\t</Button>\r\n\t\t\t\t</Div>\r\n         </Panel>\r\n      );\r\n   }\r\n}\r\n\r\nexport default Question;\r\n","import React from 'react';\r\nimport {View} from '@vkontakte/vkui';\r\nimport '@vkontakte/vkui/dist/vkui.css';\r\n\r\nimport Question from './Question';\r\n\r\nclass QuePoll extends React.Component{\r\n   constructor(props){\r\n         super(props);\r\n         this.state = {\r\n            history: [],\r\n            activePanel: \"question0\"\r\n         }\r\n   }\r\n\r\n   goBack = () => {\r\n      const hist = [...this.state.history];\r\n      if(hist.length > 0){\r\n         const last = hist.pop();\r\n         var n = parseInt(last.match(/\\d+/));\r\n         if(n >= 0){\r\n            this.setState({ history: hist });\r\n            this.setState({ activePanel: 'question' + n });\r\n         }\r\n      } else{\r\n         this.props.sv(\"home\");\r\n      }\r\n   }\r\n\r\n   goForward = (e) => {\r\n      const queId = e.currentTarget.dataset.to;\r\n      const hist = [...this.state.history];\r\n      var n = parseInt(queId.match(/\\d+/));\r\n      if(Object.keys(this.props.data.items).length > n + 1){\r\n         hist.push(queId);\r\n         this.setState({ history: hist });\r\n         n++;\r\n         this.setState({ activePanel: 'question' + n });\r\n      }\r\n   }\r\n\r\n   render(){\r\n      return(\r\n         <View id={this.props.id} activePanel={this.state.activePanel}>\r\n            {Object.keys(this.props.data.items).map((i) => {\r\n               return <Question id={\"question\" + i} data={this.props.data.items[i]} goF={this.goForward} goB={this.goBack}></Question>;\r\n            })}\r\n         </View>\r\n      );\r\n   }\r\n}\r\n\r\nexport default QuePoll;\r\n","import React from 'react';\nimport connect from '@vkontakte/vkui-connect';\nimport {Root} from '@vkontakte/vkui';\nimport '@vkontakte/vkui/dist/vkui.css';\n\n\nimport Home from './panels/Home';\nimport Error from './panels/Error';\nimport QuePoll from './panels/QuePoll';\n\nclass App extends React.Component {\n\tconstructor(props) {\n\t\tsuper(props);\n\n\t\tthis.state = {\n\t\t\tdata: [],\n\t\t\tactiveView: 'home',\n\t\t\tfetchedUser: null,\n\t\t\tisLoading: false,\n\t\t\tpollId: ''\n\t\t};\n\t}\n\n\tcomponentDidMount() {\n\t\tconnect.subscribe((e) => {\n\t\t\tswitch (e.detail.type) {\n\t\t\t\tcase 'VKWebAppGetUserInfoResult':\n\t\t\t\t\tthis.setState({ fetchedUser: e.detail.data });\n\t\t\t\t\tbreak;\n\t\t\t\tdefault:\n\t\t\t\t\tconsole.log(e.detail.type);\n\t\t\t}\n\t\t});\n\t\tconnect.send('VKWebAppGetUserInfo', {});\n\n\t\t//Обработка входящих параметров\n\t\tconst hashParams = this.parseQueryString(window.location.hash);\n\t\tconsole.log(Object.keys(hashParams));\n\t\tif(Object.keys(hashParams).includes('poll')){\n\t\t\tObject.keys(hashParams).map((key) => {\n\t\t\t\t let value = hashParams[key];\n\t\t\t\t if(key === 'poll'){\n\t\t\t\t\t this.setState({'pollId': value});\n\t\t\t\t\t this.getPoll(value);\n\t\t\t\t }\n\t\t\t\t return [];\n\t\t\t});\n\t\t} else {\n\t\t\tthis.switchView('error');\n\t\t}\n\t};\n\n\tswitchView = (id) => {\n\t\tthis.setState({ activeView: id })\n\t}\n\n\tgo = (e) => {\n\t\tthis.setState({ activeView: e.currentTarget.dataset.to });\n\t};\n\n\t//Получение вопросов\n\tgetPoll= (id) => {\n\t\ttry {\n\t\t\tvar xhr = new XMLHttpRequest();\n\t\t\txhr.open('GET', 'http://localhost:3012/getpoll?id=' + id, false);\n\t\t\txhr.send();\n\t\t\tif (xhr.status !== 200) {\n\t\t\t  this.switchView('error');\n\t\t\t} else {\n\t\t\t  var res = JSON.parse(xhr.responseText);\n\t\t\t  if(res.ok === false){\n\t\t\t\t  this.switchView('error');\n\t\t\t\t  return;\n\t\t\t  }\n\t\t\t  this.setState({data: res});\n\t\t\t}\n\t\t} catch(ex){\n\t\t\tthis.switchView('error');\n\t\t}\n\t};\n\n\t//Парсим строку параметров\n\tparseQueryString = (string) => {\n\t\t return string.slice(1).split('&')\n\t\t\t  .map((queryParam) => {\n\t\t\t\t\tlet kvp = queryParam.split('=');\n\t\t\t\t\treturn {key: kvp[0], value: kvp[1]}\n\t\t\t  })\n\t\t\t  .reduce((query, kvp) => {\n\t\t\t\t\tquery[kvp.key] = kvp.value;\n\t\t\t\t\treturn query\n\t\t\t  }, {})\n\t  };\n\n\trender() {\n\t\treturn (\n\t\t\t<Root activeView={this.state.activeView}>\n\t\t\t\t<Error id=\"error\" go={this.go} />\n\t\t\t\t<QuePoll id=\"quepoll\" data={this.state.data} sv={this.switchView} />\n\t\t\t\t<Home id=\"home\" fetchedUser={this.state.fetchedUser} go={this.go} />\n\t\t\t</Root>\n\t\t);\n\t}\n}\n\nexport default App;\n","import 'core-js/es6/map';\nimport 'core-js/es6/set';\nimport React from 'react';\nimport ReactDOM from 'react-dom';\nimport connect from '@vkontakte/vkui-connect';\nimport App from './App';\n\n// Init VK App\nconnect.send('VKWebAppInit', {});\nReactDOM.render(<App />, document.getElementById('root'));\n"],"sourceRoot":""}